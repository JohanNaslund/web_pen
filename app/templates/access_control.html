<!-- app/templates/access_control.html -->
{% extends "base.html" %}
{% block title %}Access Control Testing{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h2>Access Control Testing</h2>
            </div>
            <div class="card-body">
                <div class="alert alert-info">
                    <h5>Testa för dataläckage mellan användarnivåer</h5>
                    <p>Detta verktyg hjälper dig att identifiera om olika användarnivåer kan komma åt varandras data eller funktionalitet.</p>
                </div>
                
                <!-- Steg 1: Reset ZAP -->
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5>Steg 1: Förbered testning</h5>
                    </div>
                    <div class="card-body">
                        <p>Börja med att nollställa ZAP för att säkerställa ren testmiljö.</p>
                        <button id="reset-zap-btn" class="btn btn-warning">
                            <i class="bi bi-arrow-clockwise"></i> Nollställ ZAP
                        </button>
                        <div id="reset-status" class="mt-2"></div>
                    </div>
                </div>
                
                <!-- Steg 2: Samla URLs -->
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5>Steg 2: Samla URL:er från olika användarsessioner</h5>
                    </div>
                    <div class="card-body">
                        <p>Logga in som olika användare och samla URL:er de har åtkomst till.</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <label for="target-url" class="form-label">Target URL</label>
                                <input type="url" class="form-control" id="target-url" placeholder="https://example.com">
                            </div>
                            <div class="col-md-6">
                                <label for="session-label" class="form-label">Sessionsetikett (t.ex. "admin", "user", "guest")</label>
                                <input type="text" class="form-control" id="session-label" placeholder="admin">
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <button id="collect-urls-btn" class="btn btn-primary">
                                <i class="bi bi-collection"></i> Samla URL:er från nuvarande ZAP-session
                            </button>
                        </div>
                        
                        <div id="collection-status" class="mt-2"></div>
                    </div>
                </div>
                
                <!-- Steg 3: Visa insamlade sessioner -->
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5>Steg 3: Insamlade sessioner</h5>
                    </div>
                    <div class="card-body">
                        <div id="sessions-list">
                            <p class="text-muted">Laddar sessioner...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Steg 4: Testa Access Control -->
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5>Steg 4: Testa Access Control</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <label for="source-session-select" class="form-label">Käll-session (URL:er att testa)</label>
                                <select class="form-select" id="source-session-select">
                                    <option value="">Välj session...</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="test-cookies" class="form-label">Test-cookies (nuvarande användarens cookies)</label>
                                <input type="text" class="form-control" id="test-cookies" placeholder="sessionid=abc123; csrftoken=def456">
                            </div>
                            <div class="col-md-4">
                                <label for="test-label" class="form-label">Test-etikett</label>
                                <input type="text" class="form-control" id="test-label" placeholder="normal_user">
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <button id="start-test-btn" class="btn btn-danger">
                                <i class="bi bi-shield-exclamation"></i> Starta Access Control Test
                            </button>
                        </div>
                        
                        <div id="test-status" class="mt-2"></div>
                    </div>
                </div>
                
                <!-- Steg 5: Resultat -->
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5>Testresultat</h5>
                    </div>
                    <div class="card-body">
                        <div id="test-results">
                            <p class="text-muted">Inga testresultat ännu.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/access_control.js') }}"></script>
{% endblock %}